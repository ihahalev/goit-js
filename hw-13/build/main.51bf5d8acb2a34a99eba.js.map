{"version":3,"sources":["webpack:///./apiService.js","webpack:///./index.js","webpack:///./layout.js","webpack:///./templates/photo-card.hbs"],"names":["page","query","imgType","orientation","apiKey","this","str","encodeURIComponent","fetchQuery","queryOptions","resource","authorization","fetch","response","json","data","incrementPage","resetPage","lightbox","basicLightbox","PNotify","width","refs","searchForm","document","querySelector","gallery","loadMoreBnt","addEventListener","e","preventDefault","window","scrollTo","innerHTML","apiService","searchQuery","currentTarget","elements","value","searchQueryHandler","event","imageUrl","target","dataset","source","imageAlt","getAttribute","element","show","masonryInstance","Masonry","columnWidth","itemSelector","percentPosition","transitionDuration","stagger","initLayout","imgLoadedInstance","imgLoaded","console","log","firstLoad","collection","text","total","style","visibility","insertListItems","hits","on","top","visualViewport","pageTop","innerHeight","behavior","items","markups","map","item","markup","photoCard","li","createElement","classList","add","insertAdjacentHTML","domMarkup","append","appended","layout","Handlebars","module","exports","template","container","depth0","helpers","partials","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call"],"mappings":"8TAAA,I,EAcY,EAZG,GACbA,KAAM,EACNC,MAAO,GACPC,QAAS,QACTC,YAAa,aACbC,OAAQ,qCACR,kBACE,OAAOC,KAAKJ,OAEd,gBAAgBK,GACdD,KAAKJ,MAAQM,mBAAmBD,IAElCE,Y,EAAU,yBAAE,kHACJC,EADI,eAC0BJ,KAAKH,QAD/B,gBACsDG,KAAKF,YAC/DO,EAFI,MAEaL,KAAKJ,MAFlB,SAEgCI,KAAKL,KAFrC,eAGJW,EAHI,QAGoBN,KAAKD,OAHzB,kBAKeQ,MAnBb,2BAoBEH,EAAeC,EAAWC,GAN9B,cAKFE,EALE,gBAQWA,EAASC,OARpB,cAQFC,EARE,yBAUDA,GAVC,sGAAF,E,8KAAA,4CAeVC,cA3Ba,WA4BXX,KAAKL,MAAQ,GAEfiB,UA9Ba,WA+BXZ,KAAKL,KAAO,I,maCtBhB,IAAMkB,EAAWC,SAAA,yCAEjBC,WAAiBC,MAAQ,QAEzB,IAAMC,EAAO,CACXC,WAAYC,SAASC,cAAc,gBACnCC,QAASF,SAASC,cAAc,YAChCE,YAAaH,SAASC,cAAc,UAGtCH,EAAKC,WAAWK,iBAAiB,UAiBjC,SAA2BC,GACzBA,EAAEC,iBACFC,OAAOC,SAAS,EAAG,GA0DnBV,EAAKI,QAAQO,UAAY,+BAxDzBC,EAAWjB,YACXiB,EAAWC,YAAcN,EAAEO,cAAcC,SAASpC,MAAMqC,MACxDC,GAAmB,MAtBrBjB,EAAKK,YAAYC,iBAAiB,S,8CAClCN,EAAKI,QAAQE,iBAAiB,SA8E9B,SAAmBY,GACjBA,EAAMV,iBAEN,IAAMW,EAAWD,EAAME,OAAOC,QAAQC,OAChCC,EAAWL,EAAME,OAAOI,aAAa,OAC3C5B,EAAS6B,UAAUd,UAAnB,aAA4CQ,EAA5C,UAA8DI,EAA9D,MACA3B,EAAS8B,UA/EX,IAAMC,EAAkB,IAAIC,IAAQ,QAAS,CAC3CC,YAAa,cACbC,aAAc,aACdC,iBAAiB,EACjBC,mBAAoB,OACpBC,QAAS,GACTC,YAAY,IAEVC,EAAoBC,IAAUlC,SAASC,cAAc,U,iDAYzD,WAAkCI,GAAlC,uFACEA,EAAEC,iBAEFI,EAAWlB,gBAHb,kBAKUuB,GAAmB,GAL7B,6DAOIoB,QAAQC,IAAR,MAPJ,+D,+BAYerB,E,mFAAf,WAAkCsB,GAAlC,sGAAkCA,OAAY,GAA9C,SAC2B3B,EAAW1B,aADtC,OACQsD,EADR,gBAGQD,GACFzC,OAAa,CACX2C,KAAM,aAAaD,EAAWE,MAA1B,aAGJF,EAAWE,MAAQ,KACrB1C,EAAKK,YAAYsC,MAAMC,WAAa,WAEtCC,EAAgBL,EAAWM,MACtBP,GAEHJ,EAAkBY,GAAG,QAAQ,WAC3BtC,OAAOC,SAAS,CACdsC,IAAKvC,OAAOwC,eAAeC,QAAUzC,OAAO0C,YAC5CC,SAAU,cAjBpB,wDAsBIf,QAAQC,IAAR,MAtBJ,gE,sBA2BA,SAASO,EAAgBQ,GAAO,MACxBC,ECtFO,SAAmBD,GAShC,OARgBA,EAAME,KAAI,SAAAC,GACxB,IAAMC,EAASC,IAAUF,GACnBG,EAAKzD,SAAS0D,cAAc,MAIlC,OAHAD,EAAGE,UAAUC,IAAI,aACjBH,EAAGE,UAAUC,IAAI,iBACjBH,EAAGI,mBAAmB,YAAaN,GAC5BE,KD+EOK,CAAUX,IAC1B,EAAArD,EAAKI,SAAQ6D,OAAb,QAAuBX,GACvB3B,EAAgBuC,SAASZ,IACzBnB,EAAoBC,IAAUlC,SAASC,cAAc,WACnC4C,GAAG,YAAY,WAC/BpB,EAAgBwC,c,qBE7FpB,IAAIC,EAAa,EAAQ,QAEzBC,EAAOC,SAAWF,EAAoB,SAAKA,GAAYG,SAAS,CAAC,SAAW,CAAC,EAAE,YAAY,KAAO,SAASC,EAAUC,EAAOC,EAAQC,EAASlF,GACzI,IAAImF,EAAQC,EAAiB,MAAVJ,EAAiBA,EAAUD,EAAUM,aAAe,GAAKC,EAAOP,EAAUQ,MAAMC,cAAeC,EAAO,WAAYC,EAAOX,EAAUY,iBAAkBC,EAAiBb,EAAUa,gBAAkB,SAASC,EAAQC,GAClO,GAAIC,OAAOC,UAAUC,eAAeC,KAAKL,EAAQC,GAC/C,OAAOD,EAAOC,IAKtB,MAAO,2CACHJ,SAASP,EAAmI,OAAzHA,EAASS,EAAeX,EAAQ,kBAA8B,MAAVD,EAAiBY,EAAeZ,EAAO,gBAAkBA,IAAmBG,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAAC,KAAO,eAAe,KAAO,GAAG,KAAOpF,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,EAAE,OAAS,IAAI,IAAM,CAAC,KAAO,EAAE,OAAS,OAASmF,GACxU,UACAO,SAASP,EAAmH,OAAzGA,EAASS,EAAeX,EAAQ,UAAsB,MAAVD,EAAiBY,EAAeZ,EAAO,QAAUA,IAAmBG,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAAC,KAAO,OAAO,KAAO,GAAG,KAAOpF,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,EAAE,OAAS,IAAI,IAAM,CAAC,KAAO,EAAE,OAAS,OAASmF,GAChT,kBACAO,SAASP,EAAqI,OAA3HA,EAASS,EAAeX,EAAQ,mBAA+B,MAAVD,EAAiBY,EAAeZ,EAAO,iBAAmBA,IAAmBG,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAAC,KAAO,gBAAgB,KAAO,GAAG,KAAOpF,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,EAAE,OAAS,IAAI,IAAM,CAAC,KAAO,EAAE,OAAS,OAASmF,GAC3U,4HACAO,SAASP,EAAqH,OAA3GA,EAASS,EAAeX,EAAQ,WAAuB,MAAVD,EAAiBY,EAAeZ,EAAO,SAAWA,IAAmBG,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAAC,KAAO,QAAQ,KAAO,GAAG,KAAOpF,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,EAAE,OAAS,GAAG,IAAM,CAAC,KAAO,EAAE,OAAS,OAASmF,GAClT,yGACAO,SAASP,EAAqH,OAA3GA,EAASS,EAAeX,EAAQ,WAAuB,MAAVD,EAAiBY,EAAeZ,EAAO,SAAWA,IAAmBG,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAAC,KAAO,QAAQ,KAAO,GAAG,KAAOpF,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,GAAG,OAAS,GAAG,IAAM,CAAC,KAAO,GAAG,OAAS,OAASmF,GACpT,sGACAO,SAASP,EAA2H,OAAjHA,EAASS,EAAeX,EAAQ,cAA0B,MAAVD,EAAiBY,EAAeZ,EAAO,YAAcA,IAAmBG,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAAC,KAAO,WAAW,KAAO,GAAG,KAAOpF,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,GAAG,OAAS,GAAG,IAAM,CAAC,KAAO,GAAG,OAAS,OAASmF,GAC7T,6GACAO,SAASP,EAA6H,OAAnHA,EAASS,EAAeX,EAAQ,eAA2B,MAAVD,EAAiBY,EAAeZ,EAAO,aAAeA,IAAmBG,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAAC,KAAO,YAAY,KAAO,GAAG,KAAOpF,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,GAAG,OAAS,GAAG,IAAM,CAAC,KAAO,GAAG,OAAS,OAASmF,GAChU,sCACJ,SAAU,M","file":"main.51bf5d8acb2a34a99eba.js","sourcesContent":["const baseUrl = 'https://pixabay.com/api/';\r\n\r\nexport default {\r\n  page: 1,\r\n  query: '',\r\n  imgType: 'photo',\r\n  orientation: 'horizontal',\r\n  apiKey: '16573649-3de34e680630468dd865749b6',\r\n  get searchQuery() {\r\n    return this.query;\r\n  },\r\n  set searchQuery(str) {\r\n    this.query = encodeURIComponent(str);\r\n  },\r\n  fetchQuery: async function () {\r\n    const queryOptions = `?image_type=${this.imgType}&orientation=${this.orientation}`;\r\n    const resource = `&q=${this.query}&page=${this.page}&per_page=12`;\r\n    const authorization = `&key=${this.apiKey}`;\r\n    try {\r\n      const response = await fetch(\r\n        baseUrl + queryOptions + resource + authorization,\r\n      );\r\n      const data = await response.json();\r\n      // incrementPage();\r\n      return data;\r\n    } catch (err) {\r\n      throw err;\r\n    }\r\n  },\r\n  incrementPage() {\r\n    this.page += 1;\r\n  },\r\n  resetPage() {\r\n    this.page = 1;\r\n  },\r\n};\r\n","import './styles.css';\nimport * as PNotify from '@pnotify/core';\nimport '@pnotify/core/dist/PNotify.css';\nimport '@pnotify/core/dist/BrightTheme.css';\n\nimport apiService from './apiService';\nimport domMarkup from './layout';\n\nimport * as basicLightbox from 'basiclightbox';\nimport 'basicLightbox/dist/basicLightbox.min.css';\n\nconst lightbox = basicLightbox.create(`<div class=\"lightbox__content\"></div>`);\n\nPNotify.defaults.width = '400px';\n\nconst refs = {\n  searchForm: document.querySelector('#search-form'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBnt: document.querySelector('.more'),\n};\n\nrefs.searchForm.addEventListener('submit', searchFormHandler);\nrefs.loadMoreBnt.addEventListener('click', loadMoreBntHandler);\nrefs.gallery.addEventListener('click', openImage);\n\nimport Masonry from 'masonry-layout';\nimport imgLoaded from 'imagesloaded';\n\nconst masonryInstance = new Masonry('.grid', {\n  columnWidth: '.grid-sizer',\n  itemSelector: '.grid-item',\n  percentPosition: true,\n  transitionDuration: '0.2s',\n  stagger: 50,\n  initLayout: true,\n});\nlet imgLoadedInstance = imgLoaded(document.querySelector('.grid'));\n\nfunction searchFormHandler(e) {\n  e.preventDefault();\n  window.scrollTo(0, 0);\n  clearListItems();\n  apiService.resetPage();\n  apiService.searchQuery = e.currentTarget.elements.query.value;\n  searchQueryHandler(true);\n  // e.currentTarget.elements.query.value = '';\n}\n\nasync function loadMoreBntHandler(e) {\n  e.preventDefault();\n\n  apiService.incrementPage();\n  try {\n    await searchQueryHandler(false);\n  } catch (err) {\n    console.log(err);\n    throw err;\n  }\n}\n\nasync function searchQueryHandler(firstLoad = false) {\n  const collection = await apiService.fetchQuery();\n  try {\n    if (firstLoad) {\n      PNotify.info({\n        text: `There are ${collection.total} results`,\n      });\n    }\n    if (collection.total > 12) {\n      refs.loadMoreBnt.style.visibility = 'visible';\n    }\n    insertListItems(collection.hits);\n    if (!firstLoad) {\n      // imgLoadedInstance = imgLoaded(document.querySelector('.grid'));\n      imgLoadedInstance.on('done', () => {\n        window.scrollTo({\n          top: window.visualViewport.pageTop + window.innerHeight,\n          behavior: 'smooth',\n        });\n      });\n    }\n  } catch (err) {\n    console.log(err);\n    throw err;\n  }\n}\n\nfunction insertListItems(items) {\n  const markups = domMarkup(items);\n  refs.gallery.append(...markups);\n  masonryInstance.appended(markups);\n  imgLoadedInstance = imgLoaded(document.querySelector('.grid'));\n  imgLoadedInstance.on('progress', () => {\n    masonryInstance.layout();\n  });\n}\n\nfunction clearListItems() {\n  refs.gallery.innerHTML = '<li class=\"grid-sizer\"></li>';\n}\n\nfunction openImage(event) {\n  event.preventDefault();\n\n  const imageUrl = event.target.dataset.source;\n  const imageAlt = event.target.getAttribute('alt');\n  lightbox.element().innerHTML = `<img src=\"${imageUrl}\" alt=\"${imageAlt}\"/>`;\n  lightbox.show();\n}\n","import photoCard from './templates/photo-card.hbs';\r\n\r\nexport default function domMarkup(items) {\r\n  const markups = items.map(item => {\r\n    const markup = photoCard(item);\r\n    const li = document.createElement('li');\r\n    li.classList.add('grid-item');\r\n    li.classList.add('gallery__item');\r\n    li.insertAdjacentHTML('beforeend', markup);\r\n    return li;\r\n  });\r\n  return markups;\r\n\r\n  // WTF не осуществляеться вставка\r\n  // const markups = photoCard(items);\r\n  // const ul = document.createElement('ul');\r\n  // // ul.classList.add('blank');\r\n  // ul.insertAdjacentHTML('beforeend', markups);\r\n  // const list = ul.querySelector('.grid-item');\r\n  // console.log(ul);\r\n  // console.log(ul.children);\r\n  // console.log(list);\r\n  // return ul.children;\r\n}\r\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"photo-card\\\">\\r\\n  <img src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":2,\"column\":12},\"end\":{\"line\":2,\"column\":28}}}) : helper)))\n    + \"\\\" alt=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"tags\") || (depth0 != null ? lookupProperty(depth0,\"tags\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"tags\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":2,\"column\":35},\"end\":{\"line\":2,\"column\":43}}}) : helper)))\n    + \"\\\" data-source=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"largeImageURL\") || (depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":2,\"column\":58},\"end\":{\"line\":2,\"column\":75}}}) : helper)))\n    + \"\\\" />\\r\\n\\r\\n  <div class=\\\"stats\\\">\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n      \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":7,\"column\":6},\"end\":{\"line\":7,\"column\":15}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">visibility</i>\\r\\n      \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":11,\"column\":6},\"end\":{\"line\":11,\"column\":15}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">comment</i>\\r\\n      \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":15,\"column\":6},\"end\":{\"line\":15,\"column\":18}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n      \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":19,\"column\":6},\"end\":{\"line\":19,\"column\":19}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n  </div>\\r\\n</div>\";\n},\"useData\":true});"],"sourceRoot":""}